# CardWizard Project Planning

## 背景和动机
CardWizard 是一款集"刷哪张卡最划算 + 预算追踪 + 积分规划"功能于一体的个人理财 Web App。用户可以通过该应用实时获取返现/积分推荐，分析消费必要性，并可视化预算使用情况。这款应用旨在帮助用户优化信用卡使用策略，最大化返现和积分收益，同时保持合理的消费习惯。

技术栈包括：
- 前端：Next.js 14 + TypeScript + Tailwind + shadcn/ui
- 后端：NestJS (TypeScript)
- 数据库：PostgreSQL（交易/规则）+ Redis（缓存）
- 外部 API：Plaid Transactions、CardPointers（返现/积分规则）、OpenAI（GPT-4o 消费分析）
- DevOps：Git (GitHub) + Vercel

## 关键挑战和分析
1. **数据集成与同步挑战**：需要通过 Plaid API 获取用户银行交易数据，并与信用卡返现/积分规则数据库保持同步。

2. **实时推荐算法设计**：基于用户的消费类别、商家和金额，实时推荐最优的信用卡选择，需要高效的算法和缓存策略。

3. **用户隐私与安全**：处理敏感的财务数据，需要强健的安全措施和符合相关法规的隐私保护机制。

4. **消费分析智能化**：利用 OpenAI API 分析消费必要性和模式，需要设计合理的 prompt 和返回结果处理逻辑。

5. **多卡积分优化策略**：针对用户持有的多张信用卡，设计算法帮助用户规划如何最优化使用每张卡来最大化积分收益。

## 高层任务拆分

### Sprint 0: 项目初始化
1. **初始化项目结构**
   - 初始化 Git 仓库和基本的 README.md
   - 设置 Next.js + NestJS monorepo (pnpm workspaces)
   - 配置基本的开发环境和工具链
   
   **成功标准**：能成功启动前后端开发服务器，并通过基本的 health check。

### Sprint 1: 基础架构与 Plaid 集成
1. **设计数据库模型**
   - 设计用户、账户、交易和信用卡规则的数据模型
   - 创建 PostgreSQL 迁移脚本
   - 实现基本的数据访问层
   
   **成功标准**：完成数据库模型设计文档，成功运行迁移脚本创建表结构。

2. **Plaid API 集成**
   - 实现 Plaid Link 前端集成
   - 开发后端 Plaid API 服务
   - 处理用户银行账户连接和授权流程
   
   **成功标准**：用户能够成功连接测试银行账户，并能在系统中查看交易数据。

3. **静态返现规则表设计与实现**
   - 设计信用卡规则数据结构
   - 创建信用卡规则管理 API
   - 导入初始的信用卡返现规则数据
   
   **成功标准**：系统能够存储和查询基本的信用卡返现规则。

### Sprint 2: 核心功能开发
1. **交易分类与标签系统**
   - 实现交易自动分类逻辑
   - 开发用户自定义标签功能
   - 设计交易搜索和过滤功能
   
   **成功标准**：系统能够准确分类 80% 以上的常见交易，用户能添加和管理自定义标签。

2. **返现/积分推荐引擎**
   - 开发基于交易类别的卡片推荐算法
   - 实现推荐结果缓存机制
   - 设计用户反馈和改进机制
   
   **成功标准**：根据交易类别和商家信息，系统能够推荐出返现/积分最高的卡片选择。

3. **预算追踪功能**
   - 实现用户预算设置界面
   - 开发预算使用情况追踪逻辑
   - 设计预算警告和通知机制
   
   **成功标准**：用户能够设置按类别的月度预算，并接收到预算使用情况的实时反馈。

### Sprint 3: 高级特性与集成
1. **OpenAI 消费分析集成**
   - 设计消费必要性分析 prompt
   - 实现 OpenAI API 集成服务
   - 开发消费模式洞察和建议功能
   
   **成功标准**：系统能够对用户的消费提供有意义的必要性评分和改进建议。

2. **积分规划与优化**
   - 开发多卡使用策略优化算法
   - 实现积分目标设置和追踪
   - 设计积分价值计算和比较功能
   
   **成功标准**：系统能够为用户提供每月的用卡规划，以最大化积分收益。

3. **用户仪表盘与可视化**
   - 设计综合性用户仪表盘
   - 实现交易和预算数据可视化
   - 开发积分和返现收益统计功能
   
   **成功标准**：用户能够通过直观的图表和统计数据了解自己的财务状况和信用卡使用效益。

### Sprint 4: 性能优化与上线准备
1. **性能优化**
   - 实现关键 API 的缓存策略
   - 优化数据库查询性能
   - 前端加载和渲染性能优化
   
   **成功标准**：关键页面加载时间控制在 2 秒以内，API 响应时间控制在 200ms 以内。

2. **安全审查与隐私保护**
   - 实施全面的安全审查
   - 优化数据隐私保护机制
   - 实现合规性检查和文档
   
   **成功标准**：通过安全审查，确保符合相关的数据隐私法规。

3. **部署流程与监控**
   - 设置 CI/CD 流程
   - 配置生产环境监控和日志
   - 实现自动化备份和恢复策略
   
   **成功标准**：完成在 Vercel 上的生产环境部署，并建立有效的监控和告警机制。

## 项目状态看板
- [x] [/] 初始化 Git 仓库和 README.md
- [x] [/] 配置 pnpm workspace 根目录结构
- [x] [/] 迁移项目文档和目录结构
- [ ] [/apps/web] 搭建基础 Next.js 应用架构
- [ ] [/apps/api] 搭建基础 NestJS 应用架构
- [ ] [/apps/api/src/modules/plaid] 实现 Plaid API 服务
- [ ] [/apps/web/app/connect] 实现 Plaid Link 前端集成
- [ ] [/packages/database] 设计并实现数据库模型
- [ ] [/apps/api/src/modules/cards] 实现信用卡规则管理 API
- [ ] [/apps/web/app/dashboard] 开发用户仪表盘初始版本

## 当前状态/进度跟踪
已完成 Sprint 0 的项目初始化相关任务：初始化项目目录结构和基本配置。已创建 Git 仓库，添加了 README.md，配置了 pnpm workspace 的基本结构，并成功迁移了项目文档到新的目录结构中。

## 执行者反馈或请求帮助
Sprint 0 的初始化部分已全部完成。项目基础结构已经搭建好，下一步需要继续实现 Next.js 前端应用和 NestJS 后端应用的基础架构。 